#PARSER PQL
#DROPALLQUERIES
#QUERY

joinout = ENRICH({minimumSize = 42, PREDICATE = RelationalPredicate('sensorid = sid')},System.metadata, soccergame)

filterEvents = SELECT({predicate = 'entity = "Nick Gertje"'},joinout)
projection = PROJECT({attributes = ['sid','entity','ts','x','y','z']},filterEvents)
map_results = MAP({expressions = ['sid','ts',['entity','player']]},projection)
